# 澄清问题功能测试指南

## 测试前准备

1. ✅ 确保开发服务器运行在 `http://localhost:3001`
2. ✅ **在 Chrome DevTools 中取消勾选"Disable cache"**
3. ✅ 刷新页面一次
4. ✅ 关闭 DevTools 或切换到 Console 面板（避免停留在 Network 面板）

## 改进内容

### 1. 步骤式引导提问
- ✨ 一次只显示一个问题（而不是一次性显示所有问题）
- ✨ 回答后自动进入下一个问题
- ✨ 更自然的对话流程

### 2. 陈述句选项
- ✨ 选项以陈述句形式呈现（例如："我需要配色工具"）
- ✨ 点击后作为用户回答显示在对话中
- ✨ 避免了疑问句变成用户提问的尴尬

### 3. 跳过功能
- ✨ 每个问题都可以跳过
- ✨ 最后一个问题显示"直接搜索"按钮
- ✨ 灵活控制对话流程

## 测试步骤

### 测试场景 1：完整回答所有问题

1. 打开 `http://localhost:3001`
2. 点击底部 AI 输入框
3. 输入模糊查询：**"推荐工具"**
4. 点击发送

**预期结果：**
- AI 显示第一个问题："您需要哪个类别的资源？"
- 显示多个选项按钮（陈述句格式）：
  - "我需要配色工具"
  - "我需要CSS框架或模板"
  - "我需要字体资源"
  - 等等...
- 底部有"跳过这个问题"按钮

5. 点击任意选项（例如："我需要配色工具"）

**预期结果：**
- 选项内容作为用户消息显示在对话中
- AI 自动显示第二个问题："您偏好什么风格的设计？"
- 显示新的选项按钮（陈述句格式）：
  - "我偏好简约/极简风格"
  - "我偏好现代/时尚风格"
  - 等等...

6. 继续回答所有问题

**预期结果：**
- 所有问题回答完毕后，AI 自动组合查询并搜索
- 显示推荐的资源列表

### 测试场景 2：跳过部分问题

1. 输入模糊查询：**"需要设计资源"**
2. 第一个问题出现时，点击**"跳过这个问题"**

**预期结果：**
- 直接进入下一个问题
- 不影响后续流程

3. 回答第二个问题
4. 在第三个问题时点击**"直接搜索"**（如果是最后一个问题）

**预期结果：**
- 使用已有回答组合查询并搜索
- 显示推荐结果

### 测试场景 3：清晰查询（不触发澄清）

1. 输入清晰查询：**"推荐免费的配色工具，适合新手使用"**
2. 点击发送

**预期结果：**
- 不显示澄清问题
- 直接返回推荐结果和资源卡片

## 验证要点

### ✅ 视觉效果
- [ ] 问题以 `MessageContent` 组件显示（灰色背景）
- [ ] 选项按钮样式统一，hover 时有高亮效果
- [ ] 用户回答显示为蓝色气泡（右对齐）
- [ ] 整体风格与聊天界面一致

### ✅ 交互体验
- [ ] 一次只显示一个问题
- [ ] 点击选项后立即显示为用户消息
- [ ] 自动进入下一个问题，无需手动操作
- [ ] 跳过按钮功能正常
- [ ] 最后一个问题显示"直接搜索"而不是"跳过"

### ✅ 功能正确性
- [ ] 所有回答组合成完整查询
- [ ] 搜索结果准确
- [ ] 资源卡片正常显示
- [ ] 没有重复显示问题或内容

## 已知问题修复

### ✅ 修复：UI 重叠问题
- **问题**：澄清问题的文本和交互式组件同时显示，导致内容重复
- **解决**：条件渲染，有澄清问题时只显示交互式组件

### ✅ 修复：疑问句变用户提问
- **问题**：点击"您偏好什么风格？"后，这个疑问句变成了用户的提问
- **解决**：将选项改为陈述句格式（"我偏好简约风格"）

### ✅ 修复：批量显示问题
- **问题**：所有问题一次性显示在卡片中，不够自然
- **解决**：步骤式提问，一次只显示一个问题

## 如果遇到问题

### 页面不断刷新
- 取消勾选 Chrome DevTools 的"Disable cache"
- 关闭 DevTools 或切换到 Console 面板
- 刷新页面

### 澄清问题不显示
- 确保输入的查询足够模糊（例如："推荐工具"、"需要资源"）
- 检查浏览器控制台是否有错误
- 确认 API 正常响应

### 选项点击无反应
- 检查浏览器控制台错误
- 确认 `handleClarificationAnswer` 函数正常工作
- 刷新页面重试

## 下一步优化建议

1. **添加动画效果**：问题切换时添加淡入淡出动画
2. **进度指示**：显示"问题 1/3"等进度提示
3. **回退功能**：允许用户返回修改之前的回答
4. **自定义输入**：允许用户输入自定义回答而不只是选择预设选项
5. **智能跳过**：根据已有回答智能跳过某些问题

## 测试完成后

请反馈以下信息：
- [ ] 步骤式提问是否正常工作？
- [ ] 选项是否以陈述句显示？
- [ ] 跳过功能是否正常？
- [ ] 整体交互体验是否自然？
- [ ] 是否还有其他问题或改进建议？
